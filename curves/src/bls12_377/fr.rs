// Copyright (C) 2019-2022 Aleo Systems Inc.
// This file is part of the snarkVM library.

// The snarkVM library is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// The snarkVM library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with the snarkVM library. If not, see <https://www.gnu.org/licenses/>.

use snarkvm_fields::{
    FftParameters,
    FieldParameters,
    Fp256,
    Fp256Parameters,
    PoseidonDefaultParameters,
    PoseidonDefaultParametersEntry,
};
use snarkvm_utilities::biginteger::BigInteger256 as BigInteger;

/// BLS12-377 scalar field.
///
/// Roots of unity computed from modulus and R using this sage code:
///
/// ```ignore
/// q = 8444461749428370424248824938781546531375899335154063827935233455917409239041
/// R = 6014086494747379908336260804527802945383293308637734276299549080986809532403 # Montgomery R
/// s = 47
/// o = q - 1
/// F = GF(q)
/// g = F.multiplicative_generator()
/// assert g.multiplicative_order() == o
/// g2 = g ** (o/2**s)
/// assert g2.multiplicative_order() == 2**s
/// def into_chunks(val, width, n):
///     return [int(int(val) // (2 ** (width * i)) % 2 ** width) for i in range(n)]
/// print("Gen (g % q): ", g % q)
/// print("Gen (g * R % q): ", g * R % q)
/// print("Gen into_chunks(g * R % q): ", into_chunks(g * R % q, 64, 4))
/// print("2-adic gen (g2 % q): ", g2 % q)
/// print("2-adic gen (g2 * R % q): ", g2 * R % q)
/// print("2-adic gen into_chunks(g2 * R % q): ", into_chunks(g2 * R % q, 64, 4))
/// ```
pub type Fr = Fp256<FrParameters>;

pub struct FrParameters;

impl Fp256Parameters for FrParameters {}

impl FftParameters for FrParameters {
    type BigInteger = BigInteger;

    const G0: &'static [BigInteger] = &[
        BigInteger([1, 0, 0, 0]),
        BigInteger([10328383819076220041, 14191591508846097093, 12501134559794337047, 86910565973793808]),
        BigInteger([8860509688463634423, 1987637956085362503, 13747388016533910673, 576114928986390863]),
        BigInteger([11451239183071573570, 14863320799264645020, 17296555131385656521, 140084643809797821]),
        BigInteger([17832370440353462201, 18333106810824263321, 592081709184052627, 1124009604792067551]),
        BigInteger([7399880373882186903, 14920082074401070647, 7438425775669715221, 818658486517974929]),
        BigInteger([11886103921574203611, 7900299581457854050, 2214984018327368003, 642366339642326165]),
        BigInteger([10737806983021560170, 5820982809461035491, 5750192548704441927, 465523578464272533]),
        BigInteger([1367222650021696822, 1672322518064107775, 10078960202391419581, 986487607474991126]),
        BigInteger([12252719951110838550, 18129076852292119481, 2289308133397210500, 716377630588053395]),
        BigInteger([7161669555617742957, 7171998743853829052, 14756107791288332567, 356355480436309035]),
        BigInteger([15825057466535575278, 9903418121678160589, 1769614782623210113, 447679326498962790]),
        BigInteger([10228218574036997969, 12004070415054968762, 9246348467781664758, 200533709286937625]),
        BigInteger([18098780798894965748, 17529795481399142333, 10119823557918951259, 432555507793898644]),
        BigInteger([9903951228264484163, 5559958032216057869, 15313077659322292787, 246547934628626557]),
        BigInteger([7126349989788594040, 52070768223383717, 7193136164087877557, 631286313690812201]),
        BigInteger([7801994457662355801, 1836364555646277854, 5564941731559901330, 137071134080593267]),
        BigInteger([9559472289627687253, 9308127238896827012, 8930320208533150564, 328084118051734121]),
        BigInteger([6293022809541449835, 14922669920062490672, 3497929511092525094, 736476143674140075]),
        BigInteger([14558061336600611128, 7041154939072036001, 17671829569522699399, 693236437525759607]),
        BigInteger([9535558103180374512, 18361881268608121983, 3892682682935583760, 853749119434711434]),
        BigInteger([17739768187922234701, 15075361992276921864, 15167421137440264704, 532242369788578412]),
        BigInteger([10907914515346364143, 6209271290675854728, 5415096338205016089, 419058581811148251]),
        BigInteger([16988864225239867563, 4130755112397039818, 8861563209462925673, 878241424540718072]),
        BigInteger([14655983331100498150, 5874596807820613196, 1499059704537718822, 1216341841932942833]),
        BigInteger([6524040691256083718, 6984631626291977956, 15439802927076884614, 135481880343554232]),
        BigInteger([16975488988795930884, 8438389042318846703, 15265864689602131144, 822971221358226314]),
        BigInteger([6465126463985401031, 557362468350630174, 14081465346936655049, 251774333929327084]),
        BigInteger([8390639904906022556, 10834762802487057127, 756902063456738590, 751939021254114627]),
        BigInteger([264318718210153114, 16268244786609235747, 1071013645592901028, 1186044912631671388]),
        BigInteger([16082963332361088504, 2833268157911601414, 667503981191384480, 435199279794027589]),
        BigInteger([2407082920738281514, 17898911293047759185, 15387644034417337829, 702193770916434750]),
        BigInteger([1627872368810536665, 7561244056243702343, 7398253825307092333, 492579031612513421]),
        BigInteger([14363814965766413895, 16043424160153141216, 12113770651644893712, 1311085382630261813]),
        BigInteger([160808672265289875, 11698965621404878481, 13219041556003910378, 1065797723905673855]),
        BigInteger([5726292817928679402, 16724089459716313074, 5770044649623921434, 1113867084329574192]),
        BigInteger([12873695326848175934, 18276504242703308442, 5283443437588482462, 839620152228146785]),
        BigInteger([3479891445328463340, 11636439493321053313, 2358852566497956798, 781145430073233678]),
        BigInteger([4657842550065742693, 435508521282945287, 4907162540148739197, 565614983012374892]),
        BigInteger([13031361492453204928, 2783849867569517836, 1932141512236021191, 309829943764693480]),
        BigInteger([18428667878993270605, 14525453084116177715, 6553493929135623038, 964066743770695021]),
        BigInteger([5792766991368173504, 949928506900839989, 2101680897617883353, 15239351792426748]),
        BigInteger([9862964762832606287, 13142442642750468315, 3755594079781536269, 505746424606215694]),
        BigInteger([4327646083909272438, 9420086932307335678, 3141505847838916271, 76205261145910215]),
        BigInteger([11273396914731494907, 2877740843635909995, 3074218994155927244, 35458762537104357]),
        BigInteger([5529218215780142462, 10248736193902534663, 11472728933727708844, 1123814782668978998]),
        BigInteger([10957340637498495185, 18283331891637821595, 15595449814042694095, 1306055795367113560]),
        BigInteger([8989272235127538665, 13609633187624277021, 7835257567504808065, 636906864601884335]),
        BigInteger([2706138487505632607, 17677886897419899845, 1517712414611656542, 228957666158821308]),
        BigInteger([10140021879235127445, 12207491353561380472, 13248381697350908317, 920820708757282947]),
        BigInteger([9297407608374011040, 4319685183454983577, 4027303971935273663, 1185187876067246110]),
        BigInteger([5352543237129079779, 6193027764971417599, 9517080424279370690, 1305113215038061069]),
        BigInteger([12580803307467220814, 3880552646195414374, 15457750742232124727, 692168638255208850]),
        BigInteger([18023923280182448874, 2315969590295662335, 3849740279020934915, 718828619937676145]),
        BigInteger([1322360545759522220, 13251130210869051647, 9966317435153571027, 682599559577475540]),
        BigInteger([5294977704048212863, 5516251845843688826, 11936799022160396014, 986919829495422273]),
        BigInteger([8221750188606727985, 11707329177035292790, 13607448575738465086, 858894084092009170]),
        BigInteger([4818315613533754538, 5008619526998703209, 8498630433415699407, 850102303421263213]),
        BigInteger([286486321761738262, 12396654104574661575, 275160454938022696, 114779488479764036]),
        BigInteger([4534517573651896875, 15927366093650024029, 11191892011957667891, 824530257759758428]),
        BigInteger([5415497045949071189, 8461427902173723287, 3839987918726328152, 784166379768908674]),
        BigInteger([15145741959532806988, 8272818973700829185, 16082804182666417667, 944824397406403608]),
        BigInteger([2682719697130222073, 5305925695481475496, 5788296407807410347, 135555498636010052]),
        BigInteger([4290621706247301568, 16254089396818087298, 12130012185889271182, 279868934457720063]),
    ];
    const G1: &'static [BigInteger] = &[
        BigInteger([1, 0, 0, 0]),
        BigInteger([2174016681181728162, 10505838485506869491, 16610720311795037309, 1098422320772082154]),
        BigInteger([14337306730171611076, 12442514747166259275, 17248308783327290044, 823884278180763119]),
        BigInteger([11819555598581795519, 5795905642564484573, 16787362038180185979, 137848238009555491]),
        BigInteger([15696010754873740657, 13141345562885611284, 9680036141109855441, 887505112900742727]),
        BigInteger([8094637400902337544, 11030923986982411222, 14568492800775391841, 998434616253960089]),
        BigInteger([15743349235800362153, 16854408704029198285, 11472501858719476497, 442056232002570862]),
        BigInteger([7011913841580453369, 1257845697511714850, 18356315295773860917, 631162916873912075]),
        BigInteger([14117995369707848741, 2676544868778200817, 15381510150427907877, 257498018850372776]),
        BigInteger([15309486176211861136, 18023501049433145402, 4312492507269415707, 1214800721399079035]),
        BigInteger([12175476736361334417, 15936211448939068254, 5955795485205930495, 506346683653178066]),
        BigInteger([8244271101178704092, 13919199974275488081, 4665586799220107864, 331567234642528982]),
        BigInteger([1348173342820206422, 17739882268071428776, 6697297612828927531, 1090919507195974627]),
        BigInteger([15286773002988638215, 3037581007220205414, 10508634553000006246, 434382030453758617]),
        BigInteger([4183721529108856237, 6964835437962767849, 3952824280620990870, 645536135832293440]),
        BigInteger([17433298529903829176, 10885628166015438029, 7811919566610970216, 152309322801964031]),
        BigInteger([8075389433991515579, 16916339557505807697, 11298360946530060764, 1122123836554287848]),
        BigInteger([910266382784262342, 5408786257673642944, 10396142559138105019, 621029492721303740]),
        BigInteger([16009132239800207252, 5488866937398584510, 9949285773273710542, 796800748541026528]),
        BigInteger([11080242951612876083, 405556837079801864, 4333926458721890728, 1313758937909372847]),
        BigInteger([13572230147314232344, 4580658883643045381, 11616521883023806416, 328825903836218070]),
        BigInteger([868945209391639960, 14881979093714046498, 3521391922395491553, 135642054345785897]),
        BigInteger([3072581969988965747, 7517956271222234493, 8573690480832355132, 616465549476862764]),
        BigInteger([10177712583029899769, 2123407958428720479, 3344081003648636131, 997820622953296056]),
        BigInteger([10801206106027989921, 9521071065423317313, 9910635847407649047, 861924182556258001]),
        BigInteger([13608447062888457830, 3930471503540668081, 15472223422890092514, 1170169738171186213]),
        BigInteger([10015944252868034752, 7222660044165561688, 5846575524667232801, 955311113700123560]),
        BigInteger([792795520434112493, 13405246918417361531, 7188250649572429859, 1222010482668098712]),
        BigInteger([9571347463493947284, 9509053907978998358, 14929978814546757124, 291411717728375670]),
        BigInteger([13198903934686012709, 3386284264713079962, 1919578163628084551, 573577622973762392]),
        BigInteger([11129709601798144487, 15671100269912808905, 5743599458516845982, 913680772548741386]),
        BigInteger([4686971426482865041, 488114714564716444, 8742347708628419312, 439975276188395612]),
        BigInteger([10342888282698021604, 12403284485547111431, 14696235823030357764, 838681669075417381]),
        BigInteger([2222048919322969131, 10947687674320908316, 18010418799357713394, 1022220294530166850]),
        BigInteger([3761514318898972421, 2995089504982243799, 15652566519116280773, 981331180758487919]),
        BigInteger([18352518484895881753, 6130413872939986128, 8746739168602626960, 229237963893945743]),
        BigInteger([2073952010211812454, 11574927842129838430, 607808899885733879, 657513794100870105]),
        BigInteger([11166701311495008316, 4580898579861779779, 9163827004906519207, 659233499975854328]),
        BigInteger([11905212689543680226, 1727905617922635065, 16936900408398602155, 775457303441858144]),
        BigInteger([6868241242884674386, 8470639489193765293, 15860500817013285696, 1110171629620746349]),
        BigInteger([12793224683345427753, 5802979984697505172, 11798613062342313399, 535639606725254100]),
        BigInteger([2038304550167130517, 15937620981519022704, 13407582734124181998, 585095279473052139]),
        BigInteger([12336633879942800931, 16959294109310382325, 10886002401783691979, 132930395784472232]),
        BigInteger([5865121940168595851, 273899069195886504, 5888552918028629660, 504278293315252088]),
        BigInteger([1433599675820316641, 7855494254413192563, 2016544685299627217, 1216612441987635726]),
        BigInteger([18351098235336618058, 12866975274911000818, 1212447163706095996, 626360879714671350]),
        BigInteger([643516508772790028, 11851252396139384781, 14466258931330199239, 378102503808187578]),
        BigInteger([3505919690437733101, 588147921656268239, 9270836340060031561, 1298052626306142594]),
        BigInteger([9917832791820976718, 2350543168506516221, 13790403713811759469, 373565387828873889]),
        BigInteger([8628909144260783325, 13170300223887504779, 17395883713232773548, 170876511656123707]),
        BigInteger([14403986984994248477, 9491710633795766403, 8335634675816532456, 1222659680912040086]),
        BigInteger([189680712758425002, 2735619125945060171, 6207791334462296114, 908464512096286812]),
        BigInteger([1653219801812618026, 13201462863378066732, 14612728318547718161, 724065910104749719]),
        BigInteger([14157940571159403567, 9850205028960771276, 13436827650276630301, 733693002840063793]),
        BigInteger([2583012375793881167, 16314536431552564467, 9101231766011228094, 349246252361194524]),
        BigInteger([10864475066117488769, 9379614424632056296, 7794444741104576936, 1138028730975039086]),
        BigInteger([9545284928661483548, 15672436316379991703, 10900672830486121396, 1311616870444512509]),
        BigInteger([11161886822361607758, 5240816967240805631, 16128925874210252697, 1034830018455188440]),
        BigInteger([6426572462860152727, 6553064174773153368, 13463729043852160161, 27513559343051557]),
        BigInteger([15496789958382343470, 4869550039118210461, 8073331636093504838, 425466521667959782]),
        BigInteger([16035796483149778321, 260586217775192372, 16231630716330103552, 542646610673621893]),
        BigInteger([10241513862325693139, 10674124050918710612, 11876958590041349655, 1154763989571643424]),
        BigInteger([15914075130850305085, 5687699338780399490, 3680115420768151267, 354573344672124905]),
        BigInteger([17772598496229531129, 4570661520332222574, 1723181706783592110, 335256901414686667]),
    ];
    const G2: &'static [BigInteger] = &[
        BigInteger([1, 0, 0, 0]),
        BigInteger([3300847203551844483, 3339409470471498824, 13654830630444755558, 707677572403360065]),
        BigInteger([3808737952027303658, 8968531274175594265, 8106831138537735386, 95940273114358519]),
        BigInteger([6240340094889434519, 12457362201489802852, 14272401986881245903, 1140836836880766634]),
        BigInteger([15286725442987323933, 2007106475361142923, 2083317292372149883, 180974583549619563]),
        BigInteger([4928879344254545272, 205447477915931631, 16342975358082484290, 124043517202885051]),
        BigInteger([5879723146273917428, 7497083315747872314, 14605763652389699536, 554029161301843965]),
        BigInteger([1782435013831654799, 8064562028898097623, 15100886168959631775, 1313752223673936462]),
        BigInteger([4397199371149633379, 2642875832121143872, 10413799076104686281, 825642426606926497]),
        BigInteger([17488605398541457056, 6537739202823179055, 6942044294142353944, 167651502608903820]),
        BigInteger([6167141331572372930, 13244127425697484796, 1367377272237865316, 1235853789060113026]),
        BigInteger([6219120264311515850, 2671611730694328360, 14291122450923293625, 250877041462857594]),
        BigInteger([9334948944753912557, 8316692108687426445, 2355514762732518032, 594889249629181949]),
        BigInteger([8463042531574753342, 10880276325416502826, 5655100248957754103, 541139269213204291]),
        BigInteger([8468760098241828509, 17260806485631460194, 18168618761190689529, 553902638630352433]),
        BigInteger([16961148633431544197, 2659256193288005026, 9941351859662952655, 222114080429128936]),
        BigInteger([8774224414660521854, 18365829392473779644, 8655911966341339463, 684365345904928200]),
        BigInteger([1678098362087030640, 10175365796990797642, 10230799483349105239, 1161958458091428767]),
        BigInteger([12023130667708500246, 3529451519085845875, 3019935880757286210, 441961319879886362]),
        BigInteger([12797107576178586297, 8139713841117776521, 2614510128149614793, 374778649807164841]),
        BigInteger([4967339186772334697, 11596784562452533198, 10731340083798963902, 316521261802471756]),
        BigInteger([6755285973829901999, 14577997413355264685, 3243809214252099659, 98376218538415405]),
        BigInteger([14818420764090155876, 5268809609756631059, 17011653148040823771, 450317065526291561]),
        BigInteger([8337811953442126992, 5135249292683394323, 3632809417506706333, 551153239865510945]),
        BigInteger([11579760452336873479, 12906030466148087766, 11313181076935712821, 149488270615296864]),
        BigInteger([8777678305298773970, 15143992981922531268, 9322939228115847507, 69616215839254073]),
        BigInteger([3684186902149367647, 12824735318182326309, 12522269771036510894, 582815884723003992]),
        BigInteger([85103074712050494, 14153998655546265319, 14925674031898254986, 832543679895494761]),
        BigInteger([14932338383786186455, 15472025652872830260, 10047515012810574061, 344157822819101613]),
        BigInteger([4448000895097341992, 17880855845511459719, 7534165837543216474, 205681361871513370]),
        BigInteger([15565378566220042759, 8448495417237770257, 8615811478799945723, 325415036597291286]),
        BigInteger([1325604369125314617, 11743499413394557460, 10817475609245376867, 1336410602217790055]),
        BigInteger([10806033142992442180, 3075668854507278742, 8979520784635433375, 850542396786602444]),
        BigInteger([1405554314190005832, 10925936983604806873, 13398318860881746275, 1055388151797441917]),
        BigInteger([364704367254532879, 17272132364420477530, 17488814164025722858, 999493301478417165]),
        BigInteger([14711089853208257496, 3149853374231374154, 426913379372464098, 519499623639539706]),
        BigInteger([704339012428624300, 8637992328775425385, 15013353423727760537, 1324347352525360619]),
        BigInteger([9213612995694261940, 14537736608398768641, 12619849889933770755, 783755008245910211]),
        BigInteger([4114337869946005530, 3505510875481082237, 9834795287551357213, 914362147750373001]),
        BigInteger([7716261920701685018, 8195468986255641461, 4269996036734501871, 430817682984801838]),
        BigInteger([2647987873139831979, 1953592898580071800, 17623996660417401773, 474853920124029599]),
        BigInteger([9592890510158358828, 9510765628106679937, 4416387272804630742, 523247738983101948]),
        BigInteger([1916074024539453852, 6963451184160861962, 10102840070651788912, 690753980204744729]),
        BigInteger([2507833161552519276, 6161751670926007124, 12377037353768898451, 1064262297203689297]),
        BigInteger([16214992742828668705, 5477174288820587418, 6186928929912230759, 957222993806038008]),
        BigInteger([4226247784687323738, 11497954526181262970, 9613581169698439797, 487772367746636809]),
        BigInteger([11125916110270423933, 2108562410589148185, 2383939907863695899, 759089165422504034]),
        BigInteger([17830325498477906430, 16109331433143736997, 7281628729614318161, 194033597179430876]),
        BigInteger([2803865347086601367, 4757821888540547225, 17514710980080770656, 207674541092558212]),
        BigInteger([7794868509741086426, 15235072551014241384, 12748455669204781042, 213875048646260546]),
        BigInteger([14575474916539674507, 7504360646264414949, 3068065111480439548, 367324858191426255]),
        BigInteger([691497027627918716, 6109738391011965475, 2413575869394465711, 1187730140060398519]),
        BigInteger([11371144679878719028, 15543705002748236278, 17402809233124972765, 943359267863087897]),
        BigInteger([17940567747891568881, 8205100734161920858, 9562873029731463630, 220026677692594439]),
        BigInteger([11182737015143767037, 10765025603038710376, 15473979943330463819, 776531211503308378]),
        BigInteger([3183242422465029929, 7323849902041741742, 15889413726499837770, 594841400673128483]),
        BigInteger([9478534855361730190, 15919222906474438523, 1407415376008830759, 881894738047375476]),
        BigInteger([11827295490638460613, 11147667082279982565, 12068339715420856037, 620810634666158381]),
        BigInteger([2520843071847409819, 15807577569559035849, 17431583590570114405, 18963098233900474]),
        BigInteger([15684674470411901737, 10564705183578735462, 1951692835772862463, 1213348856524904889]),
        BigInteger([883151779972245830, 2368793153922082635, 9987993882081446063, 773442096657254315]),
        BigInteger([4944993357707088943, 6641921706285938632, 9385457676078593492, 967744173151862403]),
        BigInteger([12152151812214064460, 6499153239714835025, 14339468634905821595, 643921828241881867]),
        BigInteger([8217056034188602752, 15226469238266699350, 1157455294096815739, 1289841857480421362]),
    ];
    const G3: &'static [BigInteger] = &[
        BigInteger([1, 0, 0, 0]),
        BigInteger([9597527489463497832, 2333761960726968730, 16746112055805176011, 720722047058011984]),
        BigInteger([11665299291901935400, 17182857005450655341, 4636328355928986639, 367772762952845550]),
        BigInteger([2905708508797184802, 12065688476900277860, 18153435202675479937, 341289450453900294]),
        BigInteger([8069337352849774732, 6810387472871013908, 12557276942623517253, 1071767776870672597]),
        BigInteger([798533879191518829, 15165602156232671346, 10226415914771477538, 763336242777245553]),
        BigInteger([1921140736768395907, 5215699076821448209, 11228735514481340263, 32678806180698917]),
        BigInteger([17076440493711025814, 5647628042556428499, 11940928437190999954, 993226424598239183]),
        BigInteger([289374981952860296, 10127025435713098654, 2208729361928340935, 1150687475564240568]),
        BigInteger([4068041723319098857, 715735008135881036, 15823492810372718013, 1060432493860840274]),
        BigInteger([6771037437511780109, 14446082853840773704, 6587746553006912971, 472456514978806884]),
        BigInteger([11026993978664269525, 10477500416762847840, 363552067253092377, 343447142537517049]),
        BigInteger([474833578774261819, 6975146034537150500, 2990072196727790030, 545376877128790173]),
        BigInteger([1204914963500958521, 6060779524885196406, 13357914154156861245, 701076205135219110]),
        BigInteger([7222988230913329518, 12733817674925460105, 2418622364563209459, 619990594578847434]),
        BigInteger([16994328209660947388, 13770400888398373126, 3456615950681702360, 714339587673416708]),
        BigInteger([15093304075973936383, 9776219015851785266, 11568887383937677886, 1006739033513003763]),
        BigInteger([17508590605526249372, 1453337364554428729, 7746984817422742964, 516053001991316476]),
        BigInteger([3479664361011393963, 8252937101887423608, 7460479505117078193, 1273865495858512660]),
        BigInteger([12317880082088439674, 17645174488813114892, 8471025724813554100, 835464759325065252]),
        BigInteger([7615410257680962287, 15348216108898332190, 622846019342028193, 1174878962889440960]),
        BigInteger([1137828015438183512, 15526900414614823590, 887643363669727633, 937080653898683553]),
        BigInteger([2010544612498659080, 10464461751366307716, 10041290714454173640, 317905978608811537]),
        BigInteger([10010643311004855209, 11478295926170951043, 14475803073003468295, 371393980753269088]),
        BigInteger([10286462916756751401, 8901890883188461068, 9470821048957694234, 284248920642292699]),
        BigInteger([13723135069977453117, 10711939120625039115, 1746026312443859882, 1097656269178552110]),
        BigInteger([116619658928965348, 18175858217031958590, 15580205512753177194, 431096563928512644]),
        BigInteger([18343197578145544584, 8163498086580021924, 14632200523387757178, 1275343470625749175]),
        BigInteger([6439102774148449268, 6169903563704868303, 15497231131209590452, 85935247512635776]),
        BigInteger([11090751715997961681, 15866023927609708688, 9598238103807814199, 540521142614931409]),
        BigInteger([2145032346489726070, 11378977599084759518, 15994379535326658647, 142241570893624518]),
        BigInteger([11365473000276950067, 4461762530623669754, 6524789381863347930, 567038584415363923]),
        BigInteger([1150486120695289571, 3791543346167510731, 8613032656732926571, 813839133560734466]),
        BigInteger([12783424104608499181, 6823315675261828285, 1531499410597457846, 205520148109653441]),
        BigInteger([7279951717083479058, 5264425072181008760, 8471905086869737962, 271057540802743347]),
        BigInteger([16294673997903278101, 2654070776413737264, 2367111844354229316, 225425105125034441]),
        BigInteger([13789725721495028923, 15035876165980153102, 16813865222089649714, 749676991579976953]),
        BigInteger([10856291535517086709, 9082505648025459155, 7813048442313023268, 261887074860775623]),
        BigInteger([13237212444864610558, 17575332423449267714, 14707407311246281889, 369865288471268468]),
        BigInteger([11159659729619204693, 2892176902320548846, 17303290983812384599, 247781242008569041]),
        BigInteger([1729132173158786164, 11265761958637927295, 12959415083970573382, 302067931470256494]),
        BigInteger([4621097185896822165, 2742661216710499170, 3641145483757438556, 1032998289058952526]),
        BigInteger([3495268729697565457, 2928230404818861248, 1471241588564915799, 600079458786709665]),
        BigInteger([16644746626255138046, 8716306120021052175, 384140816216941786, 485622668831684825]),
        BigInteger([598842192543112949, 8151196398992002134, 10860297976081153752, 422487802281311346]),
        BigInteger([16511617683488318700, 18167538043973506099, 10607340277414130879, 300711360847308620]),
        BigInteger([16421003727124057637, 11639661128910966577, 5543910684023839571, 1264286616905695777]),
        BigInteger([8082971151656829090, 1083266110301536604, 17935356535562128334, 809228290837376039]),
        BigInteger([3325682605762873506, 15015504877910791222, 14175527768050844372, 517960193438054672]),
        BigInteger([8114861940105293184, 9525544303196835603, 11302563771018424357, 552651182759265891]),
        BigInteger([12776569770369743993, 3920274300295473318, 14954905988886772163, 264810289146048433]),
        BigInteger([2447093381971196142, 10685179903726656379, 12460164006390399225, 345597321240540721]),
        BigInteger([9940603318228294115, 15954768884837419065, 12376967339057476744, 71391003478572446]),
        BigInteger([2001461968159928852, 3782636293426224546, 11823036874831563807, 85434298620205547]),
        BigInteger([9504601241215449729, 8855421414276599855, 2687953275164873636, 649911927444410138]),
        BigInteger([336096318716105573, 12657769095616297011, 6459848866793339045, 1345046664380745325]),
        BigInteger([2543261588972466359, 15578742081699937582, 12570910022987631849, 936852787201645679]),
        BigInteger([6416317181405595093, 700852873590729723, 7478681034812180382, 982252484753420025]),
        BigInteger([3282730752999290124, 18211621072332480795, 12033738329768299403, 411128871650719732]),
        BigInteger([4641813588993908394, 13170228589723132208, 10111554468185168902, 197535543443347161]),
        BigInteger([15110787770474832237, 16491811703454753416, 10528027176480396101, 963295480880355055]),
        BigInteger([931081423927534078, 16104478709373963842, 2749451213968211801, 1331341733015531925]),
        BigInteger([9347749446257814441, 11741968628062028540, 14704987683065676636, 1152226773893262555]),
        BigInteger([11152439743325313120, 13564494868242208795, 13330750334374198643, 12626466604412218]),
    ];
    const G4: &'static [BigInteger] = &[
        BigInteger([1, 0, 0, 0]),
        BigInteger([16839302334653569483, 7806350610692982781, 9943056458881994391, 929704394376454922]),
        BigInteger([10144789091081869880, 5276676660904173699, 11321786778118072766, 828040235651688951]),
        BigInteger([8364984905322707355, 2892549878909873059, 2738260147605759229, 207738686059266565]),
        BigInteger([14026679459268555543, 17614867463469069595, 3844728541758442592, 1281214418221255993]),
        BigInteger([9721452180662198629, 16538556428523474564, 352021703015092666, 170694029001558575]),
        BigInteger([12406921214353987396, 17598682888882734341, 605068978155527819, 585260003105733782]),
        BigInteger([4768573390613799810, 1570250207935498180, 3214381811813369732, 1306967801979139185]),
        BigInteger([5610429035363378761, 5506683230076607326, 15435736246316713183, 630199525257939000]),
        BigInteger([14519177321351819000, 7283181465371752397, 6896065407789308872, 711529691370999363]),
        BigInteger([10671489061036399044, 4488918373055431028, 7379073129476846299, 1251820787639362488]),
        BigInteger([17351123312726574166, 2702144263441476949, 2252019461215512473, 1207110144111571702]),
        BigInteger([13354993679536299015, 12798817085719794760, 17677199573127884444, 152528389127265910]),
        BigInteger([9008593747549875838, 4563220864487116370, 14959479714514509255, 725299208081323550]),
        BigInteger([10389663689763128688, 10313410391714327713, 10330840107410677057, 494157390042806841]),
        BigInteger([5800984779872042714, 15995808499850798282, 15034351672024801177, 753861230095506136]),
        BigInteger([2091185604097662362, 17127246870944143349, 5486761434399919491, 1279919528069553426]),
        BigInteger([9533118946328659534, 1321104697133832064, 11668591848727889613, 142150681762998312]),
        BigInteger([8603242053117256584, 10110744747919003357, 3692074289847355269, 519555600108350084]),
        BigInteger([17246406703569856755, 1233359658848816120, 13761085694839323371, 1182968206250434754]),
        BigInteger([1987291565885281822, 3067351849653823524, 14903464816979455968, 660901819857649216]),
        BigInteger([14398261099948033094, 4400137973073004905, 2959474303550066231, 704445457004021804]),
        BigInteger([1219885935763632682, 1834236715992263489, 8384872810950515450, 280426220992979868]),
        BigInteger([17839280927831908082, 7757591097168029176, 3883714113349488376, 957422280942230153]),
        BigInteger([11549908518462535195, 6073321507587915927, 15601473331966652364, 1105619785505731348]),
        BigInteger([11395131235594665758, 11539137140084166504, 7335159275067604054, 774406290626597372]),
        BigInteger([989718559490405508, 1655838526370012387, 8672690084162696569, 337185888248893693]),
        BigInteger([6270685338685941721, 14157199831951554106, 4456996241736574541, 1224259476676549885]),
        BigInteger([17264920156555566894, 14204738316821132770, 3107428825906928174, 205756453455711009]),
        BigInteger([18051068785828038007, 16206249863994156504, 17718351672858847527, 1078058675050848851]),
        BigInteger([7456800189632713431, 17886564580276206763, 3572630640873908842, 1312569575932829773]),
        BigInteger([9118336726139554934, 12197645956530769959, 18085403006245280310, 512562093628476863]),
        BigInteger([13424026958577531300, 15479473384426506037, 17001359710774047057, 625354898110673901]),
        BigInteger([1618759181056454936, 7318504453983863055, 15134715149860199772, 478046063311226293]),
        BigInteger([13273416428367937025, 13595606511712435291, 16861367481026024020, 875981851642999502]),
        BigInteger([3554241537883448304, 10079491168365699988, 10994658946427707337, 144451121814084045]),
        BigInteger([5040144691114362115, 18362123788617081863, 10044055975780349014, 708081188706872326]),
        BigInteger([13965673398905375352, 8097011593517330420, 6255821832403644546, 934610919699950716]),
        BigInteger([552376695277289505, 9229045450734509844, 10771670327941704965, 896013084655005251]),
        BigInteger([6338310383312907542, 11034480392410535766, 3326263471120219067, 246623379668563306]),
        BigInteger([5694447761129911780, 7496578371815779650, 13671245966486247712, 1117431260395477545]),
        BigInteger([15936812532545030441, 7966514215682583968, 1302340915015699213, 257099183030821710]),
        BigInteger([2082791015929054264, 6397135282110190512, 16447726397084788392, 522853358395112619]),
        BigInteger([1674759316903091769, 3166557555515749171, 17943476216512188901, 346753869530406344]),
        BigInteger([8485107257883911622, 18218188669569255485, 2569496902441041884, 206423591657934568]),
        BigInteger([1840662284159980102, 4164508342020090252, 9139028920759898363, 1239155432371507912]),
        BigInteger([3239517759366454586, 226075473217539745, 13512631950329469172, 631496893447808203]),
        BigInteger([4244468315149283628, 8317089999241276543, 8752016468327327901, 127188021330561648]),
        BigInteger([825652977089902397, 7446681178026626476, 4289041885207205745, 73246504366383253]),
        BigInteger([16503322720612172745, 14026040307075930590, 17230654914500596894, 376393048794010308]),
        BigInteger([14130665921668702269, 7002147627182291989, 14447071186864527457, 912668728928722342]),
        BigInteger([1486434708668719775, 3475476399530671720, 10742658639658991086, 429892552984598665]),
        BigInteger([8669873904045732455, 2712077486803793304, 7287533152342303031, 623627152893273175]),
        BigInteger([11936229036503452627, 3006878062987068222, 15003297183620342797, 588596898459143597]),
        BigInteger([10394176955366059524, 16884923676252887435, 9352123169432845521, 1278617812278627379]),
        BigInteger([12126502414206309202, 14056210537621756044, 14104232565196668619, 1265678863254193915]),
        BigInteger([17783392537328819003, 8508451698354311590, 1554289784409431110, 1018052506299882288]),
        BigInteger([2844963201967632876, 11690265321101393976, 9432702828928118915, 1080677512244254567]),
        BigInteger([9252100535029246925, 15113389484212738733, 14857116191828973617, 766701549428792009]),
        BigInteger([5813224564590779858, 1241112571495610942, 7463592258578482448, 472933416913873548]),
        BigInteger([3168562972202466175, 12787816118183648367, 12192533303001182220, 578340756931441203]),
        BigInteger([10106795747420863011, 2036181535350164089, 2437762377240701263, 404888818787487826]),
        BigInteger([5670255995482441832, 12081809573474824563, 9583739430190447118, 1125248912345216699]),
        BigInteger([11029408451818962409, 18397520811738929057, 16753120717636358183, 1094670337516230497]),
    ];
    const G5: &'static [BigInteger] = &[
        BigInteger([1, 0, 0, 0]),
        BigInteger([13755737776659122100, 7812729316127440458, 9523938547420537112, 648137986191484461]),
        BigInteger([1165812272695901547, 12477727142090267391, 2985602208663590731, 1045963240577762725]),
        BigInteger([7292418523273335272, 9049222653404538756, 17861006263574219910, 569562835690693585]),
        BigInteger([11386823563897388805, 8996428867051358375, 17407367155104854965, 902542683321490548]),
        BigInteger([12757796682129453790, 15271959994902854069, 12094220134974976303, 758059742871754291]),
        BigInteger([10015943099422356883, 4576719723530664610, 13997135408047154282, 1137553604140211028]),
        BigInteger([18199750482640583711, 3396872411664311298, 1173591323105012032, 513125523444104150]),
        BigInteger([14207807180461846907, 2977462516520395126, 8289854015104591870, 838036922954485384]),
        BigInteger([2987098747936841500, 11559908442540895807, 1697152119746570296, 569731925602153486]),
        BigInteger([1994498111075120274, 16540771349333022204, 12834562854155946644, 228666354172933420]),
        BigInteger([9073338044241423081, 3503411930018488028, 17962441660128953983, 910228141119790427]),
        BigInteger([5123321121428777620, 7654545498391704587, 142361593667612606, 31162998847207292]),
        BigInteger([11560436335114049632, 9350657608307426658, 2510265186913063543, 1321019248729299941]),
        BigInteger([14320476824714440550, 3740011237790380861, 14718073165409909430, 1105431263912730646]),
        BigInteger([4173323228814697747, 1599429667083350639, 2186674581727790131, 1314733481722156533]),
        BigInteger([8702429858031186294, 9896991137985631698, 11452212551647075484, 1112923889600286310]),
        BigInteger([9916849767042999242, 11147501135131970400, 17245837539500683795, 103397227463535876]),
        BigInteger([1043722154918043809, 1713022064047544677, 639107832880109414, 1250028045731431172]),
        BigInteger([6024683472942148376, 7165053161307530036, 657219301119507513, 854330990314303510]),
        BigInteger([2300441079650589962, 12031930247976275873, 15697134801317696022, 1182730824490023700]),
        BigInteger([16942023542925340398, 16973451267995850876, 4396050261829787104, 450654142938372871]),
        BigInteger([10373250982974406136, 6133652800636599339, 15779897445004142432, 874746538274698256]),
        BigInteger([7593791434588116711, 190110895126130306, 11214200729074522673, 577128451171921705]),
        BigInteger([17656021593515454194, 1688967676435311155, 7851813778523513087, 1220502381226823712]),
        BigInteger([5675195971125649886, 16061968253067744090, 1509121045126059754, 395853470966028172]),
        BigInteger([13373254478049183976, 3049293666508421623, 18062613277413334984, 705562729450842083]),
        BigInteger([10063976707316137596, 14998682075709711242, 3032734711389523203, 608882026015977429]),
        BigInteger([6176554941659711553, 9513881875996207219, 8139698621850721660, 1066119596594810941]),
        BigInteger([9465920667615398839, 12318340200549672051, 16768245921234837641, 154749033727420348]),
        BigInteger([8227702267467482847, 13473679267203489308, 6104104289167083793, 916847615534018237]),
        BigInteger([17816887461509496346, 13019497713157867953, 2093686757673453178, 522370514490145236]),
    ];
    const HASH_INV: &'static [u8] = &[
        42, 36, 1, 55, 1, 1, 1, 11, 1, 47, 10, 1, 1, 4, 1, 20, 1, 61, 1, 1, 1, 1, 1, 18, 41, 1, 60, 1, 1, 43, 17, 1,
        53, 34, 1, 1, 1, 1, 1, 1, 40, 1, 27, 37, 1, 1, 9, 2, 26, 1, 31, 23, 1, 1, 1, 45, 1, 3, 1, 1, 1, 1, 1, 22, 52,
        1, 1, 1, 1, 14, 16, 1, 19, 32, 1, 49, 1, 1, 1, 39, 50, 1, 1, 8, 7, 1, 1, 59, 25, 5, 13, 1, 1, 1, 1, 1, 29, 12,
        1, 57, 28, 1, 30, 46, 1, 1, 1, 1, 51, 1, 1, 1, 1, 54, 6, 21, 1, 33, 1, 15, 1, 1, 1, 56, 63, 62, 1, 1, 35, 1, 1,
        1, 1, 44, 48, 58, 1, 38, 0, 24, 1,
    ];
    const HASH_MOD: usize = 141;
    const HASH_XOR: u32 = 0x7EAA;
    #[rustfmt::skip]
    const TWO_ADICITY: u32 = 47;
    /// TWO_ADIC_ROOT_OF_UNITY = 8065159656716812877374967518403273466521432693661810619979959746626482506078
    /// Encoded in Montgomery form, the value is
    /// (8065159656716812877374967518403273466521432693661810619979959746626482506078 * R % q) =
    /// 7039866554349711480672062101017509031917008525101396696252683426045173093960
    #[rustfmt::skip]
    const TWO_ADIC_ROOT_OF_UNITY: BigInteger = BigInteger([
        12646347781564978760u64,
        6783048705277173164u64,
        268534165941069093u64,
        1121515446318641358u64,
    ]);
}

impl FieldParameters for FrParameters {
    #[rustfmt::skip]
    const CAPACITY: u32 = Self::MODULUS_BITS - 1;
    /// GENERATOR = 22
    /// Encoded in Montgomery form, so the value is
    /// (22 * R) % q = 5642976643016801619665363617888466827793962762719196659561577942948671127251
    #[rustfmt::skip]
    const GENERATOR: BigInteger = BigInteger([
        2984901390528151251u64,
        10561528701063790279u64,
        5476750214495080041u64,
        898978044469942640u64,
    ]);
    #[rustfmt::skip]
    const INV: u64 = 725501752471715839u64;
    /// MODULUS = 8444461749428370424248824938781546531375899335154063827935233455917409239041
    #[rustfmt::skip]
    const MODULUS: BigInteger = BigInteger([
        725501752471715841u64,
        6461107452199829505u64,
        6968279316240510977u64,
        1345280370688173398u64,
    ]);
    #[rustfmt::skip]
    const MODULUS_BITS: u32 = 253;
    /// (r - 1)/2 =
    /// 4222230874714185212124412469390773265687949667577031913967616727958704619520
    #[rustfmt::skip]
    const MODULUS_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0x8508c00000000000,
        0xacd53b7f68000000,
        0x305a268f2e1bd800,
        0x955b2af4d1652ab,
    ]);
    #[rustfmt::skip]
    const R: BigInteger = BigInteger([
        9015221291577245683u64,
        8239323489949974514u64,
        1646089257421115374u64,
        958099254763297437u64,
    ]);
    #[rustfmt::skip]
    const R2: BigInteger = BigInteger([
        2726216793283724667u64,
        14712177743343147295u64,
        12091039717619697043u64,
        81024008013859129u64,
    ]);
    #[rustfmt::skip]
    const REPR_SHAVE_BITS: u32 = 3;
    // T and T_MINUS_ONE_DIV_TWO, where r - 1 = 2^s * t

    /// t = (r - 1) / 2^s =
    /// 60001509534603559531609739528203892656505753216962260608619555
    #[rustfmt::skip]
    const T: BigInteger = BigInteger([
        0xedfda00000021423,
        0x9a3cb86f6002b354,
        0xcabd34594aacc168,
        0x2556,
    ]);
    /// (t - 1) / 2 =
    /// 30000754767301779765804869764101946328252876608481130304309777
    #[rustfmt::skip]
    const T_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0x76fed00000010a11,
        0x4d1e5c37b00159aa,
        0x655e9a2ca55660b4,
        0x12ab,
    ]);
}

impl PoseidonDefaultParameters for FrParameters {
    const PARAMS_OPT_FOR_CONSTRAINTS: [PoseidonDefaultParametersEntry; 7] = [
        PoseidonDefaultParametersEntry::new(2, 17, 8, 31, 0),
        PoseidonDefaultParametersEntry::new(3, 17, 8, 31, 0),
        PoseidonDefaultParametersEntry::new(4, 17, 8, 31, 0),
        PoseidonDefaultParametersEntry::new(5, 17, 8, 31, 0),
        PoseidonDefaultParametersEntry::new(6, 17, 8, 31, 0),
        PoseidonDefaultParametersEntry::new(7, 17, 8, 31, 0),
        PoseidonDefaultParametersEntry::new(8, 17, 8, 31, 0),
    ];
}
